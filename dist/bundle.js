!function(t){function e(o){if(n[o])return n[o].exports;var a=n[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var n={};e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=11)}([function(t,e){t.exports={startLatitude:47.6,startLongitude:120,widthLatitude:.0625,widthLongitude:.05,getLatitude:function(t){return Math.round(1e4*(this.startLatitude-t*this.widthLongitude),4)/1e4},getLongitude:function(t){return Math.round(1e4*(this.startLongitude+t*this.widthLatitude),4)/1e4}}},function(t,e,n){var o=n(10),a=Vue.component("drop-zone",{template:'<div id="drop_zone"><div id="drop_msg">ここにMSMデータの csv ファイルをドロップしてください</div><slot name="content"></slot></div>',mounted:function(){function t(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"}function e(t){t.stopPropagation(),t.preventDefault();for(var e,a=t.dataTransfer.files,i=[],r=0;e=a[r];r++)i.push(e);i.sort(function(t,e){return t.name>e.name?1:t.name<e.name?-1:0});for(var r=0;r<i.length;r++){var e=i[r],s=(escape(e.name),new FileReader);s.onload=function(t){return function(e){var a=new o(t.name,e.target.result);n.$emit("add-mesh",a)}}(e),s.readAsText(e)}}var n=this,a=document.getElementById("drop_zone");a.addEventListener("dragover",t,!1),a.addEventListener("drop",e,!1)}});t.exports=a},function(t,e){var n=Vue.component("file-list",{template:'<ul id="file_list"><li v-for="mesh in meshes" v-bind:class="{\'selected-csv\': isActive(mesh)}">{{mesh.name}}</li></ul>',props:["meshes","active"],methods:{isActive:function(t){return t==this.active}}});t.exports=n},function(t,e,n){var o=n(0),a=Vue.component("google-map",{template:'<div id="map_canvas" style="margin-top: 0px; width:481px; height:505px"></div>',props:["active","x","y"],watch:{active:function(t){this.setHeartMap(t)},x:function(){this.setMarker()},y:function(){this.setMarker()}},mounted:function(){var t=this,e=new google.maps.LatLng(38.65,138.25),n={zoom:5,center:e,mapTypeId:google.maps.MapTypeId.ROADMAP};t.map=new google.maps.Map(document.getElementById("map_canvas"),n),t.marker=new google.maps.Marker({position:e}),t.heatmap=null},methods:{setHeartMap:function(t){for(var e=this,n=t.meshArray,a=20,i=0,r=Array.prototype.concat.apply([],n),s=0;s<r.length;s++)a<r[s]?a=r[s]:i>r[s]&&(i=r[s]);for(var u=n[0].length,c=n.length,d=[],l=0;l<c;++l)for(var h=0;h<u;++h){var m=n[l][h],p=255*(m-i)/(a-i),f=o.getLatitude(l),v=o.getLongitude(h);0!=p&&d.push({location:new google.maps.LatLng(f,v),weight:p})}null!=e.heatmap&&(e.heatmap.setMap(null),e.heatmap.setData([])),e.heatmap=new google.maps.visualization.HeatmapLayer({data:d,radius:10,maxIntensity:255,opacity:.4}),e.heatmap.setMap(e.map)},setMarker:function(){var t=this,e=o.getLatitude(t.y),n=o.getLongitude(t.x),a=new google.maps.LatLng(e,n);t.map.panTo(a),t.marker.setMap(t.map),t.marker.setPosition(a)}}});t.exports=a},function(t,e){var n=Vue.component("mesh-canvas",{template:'<div><canvas id="draw_canvas" width="481" height="505"></canvas><canvas id="cursor_canvas" width="481" height="505"></canvas>  </div>',props:["mesh"],watch:{mesh:function(){this.drawMesh()}},mounted:function(){var t=this;t.canvas=document.getElementById("draw_canvas"),t.context=t.canvas.getContext("2d"),t.cursor=document.getElementById("cursor_canvas"),t.cursor_ctx=t.cursor.getContext("2d"),t.cursor.addEventListener("mouseover",t.onMouseOver,!1),t.cursor.addEventListener("mouseout",t.onMouseOut,!1),t.cursor.addEventListener("mousemove",t.onMouseMove,!1),t.cursor.addEventListener("click",t.onClick,!1),document.onkeydown=function(e){switch(e.keyCode){case 72:t.moveFixCursor(-1,0);break;case 74:t.moveFixCursor(0,1);break;case 75:t.moveFixCursor(0,-1);break;case 76:t.moveFixCursor(1,0)}}},methods:{drawMesh:function(){var t=this,e=t.mesh.meshArray;t.canvas.width=t.cursor.width=e[0].length,t.canvas.height=t.cursor.height=e.length;var n=Array.prototype.concat.apply([],e),o=d3.max(n,function(t){return Number(t)});o=o>10?o:10,t.max=o;for(var a=t.context.getImageData(0,0,t.canvas.width,t.canvas.height),i=a.width,r=a.height,s=a.data,u=0;u<r;++u)for(var c=0;c<i;++c){var d=4*(u*i+c),l=e[u][c],h=255*l/o,m=255-h;s[d+0]=m,s[d+1]=m,s[d+2]=m,s[d+3]=255}t.canvas.style.display="block",document.getElementById("drop_msg").style.display="none",t.context.putImageData(a,0,0),document.getElementById("file_name").innerHTML=t.mesh.name,t.drawCursorLine()},moveFixCursor:function(t,e){var n=this;n.fix_x+=t,n.fix_y+=e,n.drawCursorLine(),n.$emit("move-fix-coordinate",{x:n.fix_x,y:n.fix_y})},onMouseOver:function(t){},onMouseOut:function(t){},onMouseMove:function(t){var e=this;if(null!=e.mesh){var n=t.target.getBoundingClientRect();e.x=t.clientX-n.left,e.y=t.clientY-n.top,e.drawCursorLine(),e.$emit("move-coordinate",{x:e.x,y:e.y})}},drawCursorLine:function(){var t=this;t.cursor_ctx.clearRect(0,0,t.canvas.width,t.canvas.height),t.lineToContext(t.cursor_ctx,0,t.y,t.cursor.width,t.y,"deepskyblue",.3),t.lineToContext(t.cursor_ctx,t.x,0,t.x,t.cursor.height,"deepskyblue",.3),null!=t.x&&(t.lineToContext(t.cursor_ctx,t.fix_x-10,t.fix_y,t.fix_x+10,t.fix_y,"red",.5),t.lineToContext(t.cursor_ctx,t.fix_x,t.fix_y-10,t.fix_x,t.fix_y+10,"red",.5))},lineToContext:function(t,e,n,o,a,i,r){t.globalAlpha=r,t.beginPath(),t.strokeStyle=i,t.moveTo(e,n),t.lineTo(o,a),t.closePath(),t.stroke()},onClick:function(t){var e=this;if(null!=e.mesh){var n=e.x,o=e.y;e.fix_x=n,e.fix_y=o,e.drawCursorLine(),e.$emit("move-fix-coordinate",{x:n,y:o})}},getMeshValue:function(t,e){var n=this,o=n.mesh.meshArray;return e<0||t<0||o[0].length<=e||o.length<=t?"-":o[t][e]}}});t.exports=n},function(t,e){function n(t){function e(){o.params.changeActiveMeshHandlers.forEach(function(t){t(o.active)})}function n(){for(var t=0;t<o.meshes.length;t++)if(o.meshes[t]==o.active)return t;return 0}var o=this;o.params=t,o.meshes=[],o.active=null,o.add=function(t){o.meshes.push(t),o.meshes.sort(function(t,e){return t.name>e.name?1:t.name<e.name?-1:0}),o.params.changeCollectionHandlers.forEach(function(t){t(o.meshes)}),null==o.active&&(o.active=t,e())},o.pre=function(){var t=n();t-=1,t<0&&(t=o.meshes.length-1),o.active=o.meshes[t],e()},o.next=function(){var t=n();t+=1,t>=o.meshes.length&&(t=0),o.active=o.meshes[t],e()}}t.exports=n},function(t,e,n){var o=n(0),a=Vue.component("point-info",{template:'<div><table>  <tr><td>座標</td><td>{{pos}}</td></tr>  <tr><td>緯度・経度</td><td>{{lati}}</td></tr>  <tr><td>60進数</td><td>{{lati_60}}</td></tr>  <tr><td>降水量</td><td>{{value}}</td></tr></table><table class="around">  <tr><td>{{pointValues[0][0]}}</td><td>{{pointValues[0][1]}}</td><td>{{pointValues[0][2]}}</td><td>{{pointValues[0][3]}}</td><td>{{pointValues[0][4]}}</td></tr>  <tr><td>{{pointValues[1][0]}}</td><td>{{pointValues[1][1]}}</td><td>{{pointValues[1][2]}}</td><td>{{pointValues[1][3]}}</td><td>{{pointValues[1][4]}}</td></tr>  <tr><td>{{pointValues[2][0]}}</td><td>{{pointValues[2][1]}}</td><td>{{pointValues[2][2]}}</td><td>{{pointValues[2][3]}}</td><td>{{pointValues[2][4]}}</td></tr>  <tr><td>{{pointValues[3][0]}}</td><td>{{pointValues[3][1]}}</td><td>{{pointValues[3][2]}}</td><td>{{pointValues[3][3]}}</td><td>{{pointValues[3][4]}}</td></tr>  <tr><td>{{pointValues[4][0]}}</td><td>{{pointValues[4][1]}}</td><td>{{pointValues[4][2]}}</td><td>{{pointValues[4][3]}}</td><td>{{pointValues[4][4]}}</td></tr></table></div>',props:["mesh","x","y"],data:function(){return{pos:"",lati:"",lati_60:"",value:0,pointValues:[[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0]]}},watch:{mesh:function(){this.reflesh()},x:function(){this.reflesh()},y:function(){this.reflesh()}},methods:{reflesh:function(){var t=this;if(null!=t.mesh){var e=t.x,n=t.y,a=o.getLatitude(n),i=o.getLongitude(e),r=t.mesh.meshArray;t.pos="("+e+" , "+n+")",t.lati="("+a+" , "+i+")",t.lati_60=t.conv60(a)+" , "+t.conv60(i),t.value=r[n][e]+" mm";for(var s=-2;s<3;s++)for(var u=-2;u<3;u++)t.pointValues[s+2][u+2]=t.meshValue(s,u)}},meshValue:function(t,e){var n=this;if(null==n.mesh)return 0;var o=n.mesh.meshArray,e=n.x+e,t=n.y+t;return e<0||t<0||o[0].length<=e||o.length<=t?"-":o[t][e]},conv60:function(t){var e=Math.floor(t),n=Math.floor(60*(t-e));return e+"度 "+n+"分 "+Math.floor(60*(60*(t-e)-n))+"秒"}}});t.exports=a},function(t,e){var n=Vue.component("profile-col-graph",{template:'<div><svg id="longitude_line" width="60" height="505" style="margin-top: 60px; background: black; display: block;">  <polyline stroke="deepskyblue" stroke-width="2" fill="transparent" points=""></polyline></svg></div>',props:["mesh","x","y"],data:function(){return{max:0}},watch:{mesh:function(){this.setMesh()},x:function(){this.update()},y:function(){this.update()}},methods:{setMesh:function(){var t=this,e=t.mesh.meshArray,n=Array.prototype.concat.apply([],e),o=d3.max(n,function(t){return Number(t)});o=o>10?o:10,t.max=o,t.update()},update:function(){var t=this,e=t.x,n=(t.y,t.mesh.meshArray),o=d3.scaleLinear().domain([0,t.max]).range([58,8]),a=n.map(function(t){return t[e]});d3.select("svg#longitude_line polyline").transition().duration(100).attr("points",a.map(function(t,e){return o(Number(t))+" "+e}).join(","))}}});t.exports=n},function(t,e){var n=Vue.component("profile-row-graph",{template:'<div>    <svg id="latitude_line" width="481" height="60" style="background: black; display: block;">    <polyline stroke="deepskyblue" stroke-width="2" fill="transparent" points=""></polyline>    </svg></div>',props:["mesh","x","y"],data:function(){return{max:0}},watch:{mesh:function(){this.setMesh()},x:function(){this.update()},y:function(){this.update()}},methods:{setMesh:function(){var t=this,e=t.mesh.meshArray,n=Array.prototype.concat.apply([],e),o=d3.max(n,function(t){return Number(t)});o=o>10?o:10,t.max=o,t.update()},update:function(){var t=this,e=(t.x,t.y),n=t.mesh.meshArray,o=d3.scaleLinear().domain([0,t.max]).range([55,5]);d3.select("svg#latitude_line polyline").transition().duration(100).attr("points",n[e].map(function(t,e){return e+" "+o(Number(t))}).join(","))}}});t.exports=n},function(t,e){var n=Vue.component("timeline-graph",{template:'<svg id="timeline" width="505" height="60" style="margin-top: 0px; background: black; display: block;"></svg>',props:["meshes","active","x","y"],watch:{meshes:function(){this.reflesh()},active:function(){this.reflesh()},x:function(){this.reflesh()},y:function(){this.reflesh()}},methods:{reflesh:function(){if(null!=this.meshes&&0!=this.meshes.length){var t=this,e=t.x,n=t.y,o=d3.max(t.meshes,function(t){return Number(t.meshArray[n][e])}),a=481/t.meshes.length;a=a>20?20:a;var i=d3.scaleLinear().domain([0,o]).range([2,57]),r=d3.select("svg#timeline").selectAll("rect").data(t.meshes);r.enter().append("rect"),r.exit().remove(),r=d3.select("svg#timeline").selectAll("rect").transition().attr("x",function(t,e){return e*a}).attr("y",function(t){return 56-i(Number(t.meshArray[n][e]))}).attr("width",a-2).attr("height",function(t){return i(Number(t.meshArray[n][e]))}).attr("fill",function(e){return e==t.active?"#dccb18":"deepskyblue"})}}}});t.exports=n},function(t,e){function n(t,e){function n(t){return t.split("\n").filter(function(t){return""!=t}).map(function(t){return t.split(",").filter(function(t){return""!=t})})}var o=this;o.name=t,o.meshArray=n(e)}t.exports=n},function(t,e,n){var o=n(5);n(0),n(1),n(2),n(9),n(3),n(6),n(7),n(8),n(4);new Vue({el:"#app",data:{meshes:[],active:null,x:0,y:0,fix_x:0,fix_y:0,meshCollection:null},mounted:function(){var t=this;t.meshCollection=new o({changeCollectionHandlers:[function(e){t.meshes=e}],changeActiveMeshHandlers:[function(e){t.active=e}]}),window.onload=function(){document.getElementById("pre_mesh").onclick=function(){t.meshCollection.pre()},document.getElementById("next_mesh").onclick=function(){t.meshCollection.next()}}},methods:{addMesh:function(t){this.meshCollection.add(t)},moveCoordinate:function(t){this.x=t.x,this.y=t.y},moveFixCoordinate:function(t){this.fix_x=t.x,this.fix_y=t.y}}})}]);