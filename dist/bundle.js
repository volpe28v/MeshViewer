!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=10)}([function(e,t){e.exports={startLatitude:47.6,startLongitude:120,widthLatitude:.0625,widthLongitude:.05,getLatitude:function(e){return Math.round(1e4*(this.startLatitude-e*this.widthLongitude),4)/1e4},getLongitude:function(e){return Math.round(1e4*(this.startLongitude+e*this.widthLatitude),4)/1e4}}},function(e,t){function n(e){function t(e){}function n(e){}function r(e){if(null!=m.mesh){var t=e.target.getBoundingClientRect();m.x=e.clientX-t.left,m.y=e.clientY-t.top,i(),m.params.moveHandlers.forEach(function(e){e({x:m.x,y:m.y})})}}function i(){m.cursor_ctx.clearRect(0,0,m.canvas.width,m.canvas.height),o(m.cursor_ctx,0,m.y,m.cursor.width,m.y,"deepskyblue",.3),o(m.cursor_ctx,m.x,0,m.x,m.cursor.height,"deepskyblue",.3),null!=m.x&&(o(m.cursor_ctx,m.fix_x-10,m.fix_y,m.fix_x+10,m.fix_y,"red",.5),o(m.cursor_ctx,m.fix_x,m.fix_y-10,m.fix_x,m.fix_y+10,"red",.5))}function o(e,t,n,r,i,o,a){e.globalAlpha=a,e.beginPath(),e.strokeStyle=o,e.moveTo(t,n),e.lineTo(r,i),e.closePath(),e.stroke()}function a(e){if(null!=m.mesh){var t=m.x,n=m.y;m.fix_x=t,m.fix_y=n,i(),m.params.clickHandlers.forEach(function(e){e({x:t,y:n})})}}var m=this;m.params=e,m.canvas=document.getElementById("draw_canvas"),m.context=m.canvas.getContext("2d"),m.cursor=document.getElementById("cursor_canvas"),m.cursor_ctx=m.cursor.getContext("2d"),m.mesh=null,m.cursor.addEventListener("mouseover",t,!1),m.cursor.addEventListener("mouseout",n,!1),m.cursor.addEventListener("mousemove",r,!1),m.cursor.addEventListener("click",a,!1),m.drawMesh=function(e){m.mesh=e;var t=e.meshArray;m.canvas.width=m.cursor.width=t[0].length,m.canvas.height=m.cursor.height=t.length;var n=Array.prototype.concat.apply([],t),r=d3.max(n,function(e){return Number(e)});r=r>10?r:10,m.max=r;for(var o=m.context.getImageData(0,0,m.canvas.width,m.canvas.height),a=o.width,c=o.height,u=o.data,s=0;s<c;++s)for(var d=0;d<a;++d){var l=4*(s*a+d),p=t[s][d],f=255*p/r,h=255-f;u[l+0]=h,u[l+1]=h,u[l+2]=h,u[l+3]=255}m.canvas.style.display="block",document.getElementById("drop_msg").style.display="none",m.context.putImageData(o,0,0),document.getElementById("file_name").innerHTML=e.name,i()},m.moveFixCursor=function(e,t){m.fix_x+=e,m.fix_y+=t,i(),m.params.clickHandlers.forEach(function(e){e({x:m.fix_x,y:m.fix_y})})}}e.exports=n},function(e,t,n){function r(e){function t(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}function n(t){t.stopPropagation(),t.preventDefault();for(var n,r=t.dataTransfer.files,o=[],a=0;n=r[a];a++)o.push(n);o.sort(function(e,t){return e.name>t.name?1:e.name<t.name?-1:0});for(var a=0;a<o.length;a++){var n=o[a],m=(escape(n.name),new FileReader);m.onload=function(t){return function(n){var r=new i(t.name,n.target.result);e.createMeshHandlers.forEach(function(e){e(r)})}}(n),m.readAsText(n)}}this.params=e;var r=document.getElementById(e.id);r.addEventListener("dragover",t,!1),r.addEventListener("drop",n,!1)}var i=n(9);e.exports=r},function(e,t){var n=Vue.component("file-list",{template:'<ul id="file_list"><li v-for="mesh in meshes" v-bind:class="{\'selected-csv\': isActive(mesh)}">{{mesh.name}}</li></ul>',props:["meshes","active"],methods:{isActive:function(e){return e==this.active}}});e.exports=n},function(e,t,n){var r=n(0),i=Vue.component("google-map",{template:'<div id="map_canvas" style="margin-top: 0px; width:481px; height:505px"></div>',props:["active","x","y"],watch:{active:function(e){this.setHeartMap(e)},x:function(){this.setMarker()},y:function(){this.setMarker()}},mounted:function(){var e=this,t=new google.maps.LatLng(38.65,138.25),n={zoom:5,center:t,mapTypeId:google.maps.MapTypeId.ROADMAP};e.map=new google.maps.Map(document.getElementById("map_canvas"),n),e.marker=new google.maps.Marker({position:t}),e.heatmap=null},methods:{setHeartMap:function(e){for(var t=this,n=e.meshArray,i=20,o=0,a=Array.prototype.concat.apply([],n),m=0;m<a.length;m++)i<a[m]?i=a[m]:o>a[m]&&(o=a[m]);for(var c=n[0].length,u=n.length,s=[],d=0;d<u;++d)for(var l=0;l<c;++l){var p=n[d][l],f=255*(p-o)/(i-o),h=r.getLatitude(d),g=r.getLongitude(l);0!=f&&s.push({location:new google.maps.LatLng(h,g),weight:f})}null!=t.heatmap&&(t.heatmap.setMap(null),t.heatmap.setData([])),t.heatmap=new google.maps.visualization.HeatmapLayer({data:s,radius:10,maxIntensity:255,opacity:.4}),t.heatmap.setMap(t.map)},setMarker:function(){var e=this,t=r.getLatitude(e.y),n=r.getLongitude(e.x),i=new google.maps.LatLng(t,n);e.map.panTo(i),e.marker.setMap(e.map),e.marker.setPosition(i)}}});e.exports=i},function(e,t){function n(e){function t(){r.params.changeActiveMeshHandlers.forEach(function(e){e(r.active)})}function n(){for(var e=0;e<r.meshes.length;e++)if(r.meshes[e]==r.active)return e;return 0}var r=this;r.params=e,r.meshes=[],r.active=null,r.add=function(e){r.meshes.push(e),r.meshes.sort(function(e,t){return e.name>t.name?1:e.name<t.name?-1:0}),r.params.changeCollectionHandlers.forEach(function(e){e(r.meshes)}),null==r.active&&(r.active=e,t())},r.pre=function(){var e=n();e-=1,e<0&&(e=r.meshes.length-1),r.active=r.meshes[e],t()},r.next=function(){var e=n();e+=1,e>=r.meshes.length&&(e=0),r.active=r.meshes[e],t()}}e.exports=n},function(e,t){function n(e){function t(){var e=o.x,t=o.y,n=o.params.mapInfo.getLatitude(t),a=o.params.mapInfo.getLongitude(e),m=o.mesh.meshArray;document.getElementById("pos").innerHTML="("+e+" , "+t+")",document.getElementById("lati").innerHTML="("+n+" , "+a+")",document.getElementById("60_lati").innerHTML=i(n)+" , "+i(a),document.getElementById("value").innerHTML=m[t][e]+" mm",document.getElementById("v_m2m2").innerHTML=r(t-2,e-2),document.getElementById("v_m1m2").innerHTML=r(t-2,e-1),document.getElementById("v_0m2").innerHTML=r(t-2,e),document.getElementById("v_p1m2").innerHTML=r(t-2,e+1),document.getElementById("v_p2m2").innerHTML=r(t-2,e+2),document.getElementById("v_m2m1").innerHTML=r(t-1,e-2),document.getElementById("v_m1m1").innerHTML=r(t-1,e-1),document.getElementById("v_0m1").innerHTML=r(t-1,e),document.getElementById("v_p1m1").innerHTML=r(t-1,e+1),document.getElementById("v_p2m1").innerHTML=r(t-1,e+2),document.getElementById("v_m20").innerHTML=r(t,e-2),document.getElementById("v_m10").innerHTML=r(t,e-1),document.getElementById("v_00").innerHTML=r(t,e),document.getElementById("v_p10").innerHTML=r(t,e+1),document.getElementById("v_p20").innerHTML=r(t,e+2),document.getElementById("v_m2p1").innerHTML=r(t+1,e-2),document.getElementById("v_m1p1").innerHTML=r(t+1,e-1),document.getElementById("v_0p1").innerHTML=r(t+1,e),document.getElementById("v_p1p1").innerHTML=r(t+1,e+1),document.getElementById("v_p2p1").innerHTML=r(t+1,e+2),document.getElementById("v_m2p2").innerHTML=r(t+2,e-2),document.getElementById("v_m1p2").innerHTML=r(t+2,e-1),document.getElementById("v_0p2").innerHTML=r(t+2,e),document.getElementById("v_p1p2").innerHTML=r(t+2,e+1),document.getElementById("v_p2p2").innerHTML=r(t+2,e+2)}function n(){var e=o.fix_x,t=o.fix_y,n=o.params.mapInfo.getLatitude(t),a=o.params.mapInfo.getLongitude(e),m=o.mesh.meshArray;document.getElementById("click_pos").innerHTML="("+e+" , "+t+")",document.getElementById("click_lati").innerHTML="("+n+" , "+a+")",document.getElementById("click_60_lati").innerHTML=i(n)+" , "+i(a),document.getElementById("click_value").innerHTML=m[t][e]+" mm",document.getElementById("f_m2m2").innerHTML=r(t-2,e-2),document.getElementById("f_m1m2").innerHTML=r(t-2,e-1),document.getElementById("f_0m2").innerHTML=r(t-2,e),document.getElementById("f_p1m2").innerHTML=r(t-2,e+1),document.getElementById("f_p2m2").innerHTML=r(t-2,e+2),document.getElementById("f_m2m1").innerHTML=r(t-1,e-2),document.getElementById("f_m1m1").innerHTML=r(t-1,e-1),document.getElementById("f_0m1").innerHTML=r(t-1,e),document.getElementById("f_p1m1").innerHTML=r(t-1,e+1),document.getElementById("f_p2m1").innerHTML=r(t-1,e+2),document.getElementById("f_m20").innerHTML=r(t,e-2),document.getElementById("f_m10").innerHTML=r(t,e-1),document.getElementById("f_00").innerHTML=r(t,e),document.getElementById("f_p10").innerHTML=r(t,e+1),document.getElementById("f_p20").innerHTML=r(t,e+2),document.getElementById("f_m2p1").innerHTML=r(t+1,e-2),document.getElementById("f_m1p1").innerHTML=r(t+1,e-1),document.getElementById("f_0p1").innerHTML=r(t+1,e),document.getElementById("f_p1p1").innerHTML=r(t+1,e+1),document.getElementById("f_p2p1").innerHTML=r(t+1,e+2),document.getElementById("f_m2p2").innerHTML=r(t+2,e-2),document.getElementById("f_m1p2").innerHTML=r(t+2,e-1),document.getElementById("f_0p2").innerHTML=r(t+2,e),document.getElementById("f_p1p2").innerHTML=r(t+2,e+1),document.getElementById("f_p2p2").innerHTML=r(t+2,e+2)}function r(e,t){var n=o.mesh.meshArray;return t<0||e<0||n[0].length<=t||n.length<=e?"-":n[e][t]}function i(e){var t=Math.floor(e),n=Math.floor(60*(e-t));return t+"度 "+n+"分 "+Math.floor(60*(60*(e-t)-n))+"秒"}var o=this;o.params=e,o.mesh=null,o.x=0,o.y=0,o.fix_x=0,o.fix_y=0,o.setMesh=function(e){o.mesh=e,t(),n()},o.updateCoordinate=function(e){o.x=e.x,o.y=e.y,t()},o.updateFixedCoordinate=function(e){o.fix_x=e.x,o.fix_y=e.y,n()}}e.exports=n},function(e,t){function n(){function e(){var e=t.x,n=t.y,r=t.mesh.meshArray,i=d3.scaleLinear().domain([0,t.max]).range([55,5]);d3.select("svg#latitude_line polyline").transition().duration(100).attr("points",r[n].map(function(e,t){return t+" "+i(Number(e))}).join(","));var o=d3.scaleLinear().domain([0,t.max]).range([58,8]),a=r.map(function(t){return t[e]});d3.select("svg#longitude_line polyline").transition().duration(100).attr("points",a.map(function(e,t){return o(Number(e))+" "+t}).join(","))}var t=this;t.mesh=null,t.x=0,t.y=0,t.setMesh=function(n){t.mesh=n;var r=n.meshArray,i=Array.prototype.concat.apply([],r),o=d3.max(i,function(e){return Number(e)});o=o>10?o:10,t.max=o,e()},t.updateCoordinate=function(n){t.x=n.x,t.y=n.y,e()}}e.exports=n},function(e,t){var n=Vue.component("timeline-graph",{template:'<svg id="timeline" width="505" height="60" style="margin-top: 0px; background: black; display: block;"></svg>',props:["meshes","active","x","y"],watch:{meshes:function(){this.reflesh()},active:function(){this.reflesh()},x:function(){this.reflesh()},y:function(){this.reflesh()}},methods:{reflesh:function(){if(null!=this.meshes&&0!=this.meshes.length){var e=this,t=e.x,n=e.y,r=d3.max(e.meshes,function(e){return Number(e.meshArray[n][t])}),i=481/e.meshes.length;i=i>20?20:i;var o=d3.scaleLinear().domain([0,r]).range([2,57]),a=d3.select("svg#timeline").selectAll("rect").data(e.meshes);a.enter().append("rect"),a.exit().remove(),a=d3.select("svg#timeline").selectAll("rect").transition().attr("x",function(e,t){return t*i}).attr("y",function(e){return 56-o(Number(e.meshArray[n][t]))}).attr("width",i-2).attr("height",function(e){return o(Number(e.meshArray[n][t]))}).attr("fill",function(t){return t==e.active?"#dccb18":"deepskyblue"})}}}});e.exports=n},function(e,t){function n(e,t){function n(e){return e.split("\n").filter(function(e){return""!=e}).map(function(e){return e.split(",").filter(function(e){return""!=e})})}var r=this;r.name=e,r.meshArray=n(t)}e.exports=n},function(e,t,n){var r=n(2),i=n(1),o=n(5),a=n(6),m=n(7),c=n(0);n(3),n(8),n(4);new Vue({el:"#app",data:{meshes:[],active:null,x:0,y:0},mounted:function(){var e=new a({mapInfo:c}),t=new m,n=new i({mapInfo:c,moveHandlers:[e.updateCoordinate,t.updateCoordinate],clickHandlers:[e.updateFixedCoordinate,function(e){u.x=e.x,u.y=e.y}]}),u=this,s=new o({changeCollectionHandlers:[function(e){u.meshes=e}],changeActiveMeshHandlers:[n.drawMesh,e.setMesh,t.setMesh,function(e){u.active=e}]});new r({id:"drop_zone",createMeshHandlers:[s.add]});window.onload=function(){document.getElementById("pre_mesh").onclick=function(){s.pre()},document.getElementById("next_mesh").onclick=function(){s.next()},document.onkeydown=function(e){switch(e.keyCode){case 72:n.moveFixCursor(-1,0);break;case 74:n.moveFixCursor(0,1);break;case 75:n.moveFixCursor(0,-1);break;case 76:n.moveFixCursor(1,0)}}}}})}]);