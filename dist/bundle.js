!function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=10)}([function(e,t){e.exports={startLatitude:47.6,startLongitude:120,widthLatitude:.0625,widthLongitude:.05,getLatitude:function(e){return Math.round(1e4*(this.startLatitude-e*this.widthLongitude),4)/1e4},getLongitude:function(e){return Math.round(1e4*(this.startLongitude+e*this.widthLatitude),4)/1e4}}},function(e,t){function n(e){function t(e){}function n(e){}function a(e){if(null!=s.mesh){var t=e.target.getBoundingClientRect();s.x=e.clientX-t.left,s.y=e.clientY-t.top,r(),s.params.moveHandlers.forEach(function(e){e({x:s.x,y:s.y})})}}function r(){s.cursor_ctx.clearRect(0,0,s.canvas.width,s.canvas.height),i(s.cursor_ctx,0,s.y,s.cursor.width,s.y,"deepskyblue",.3),i(s.cursor_ctx,s.x,0,s.x,s.cursor.height,"deepskyblue",.3),null!=s.x&&(i(s.cursor_ctx,s.fix_x-10,s.fix_y,s.fix_x+10,s.fix_y,"red",.5),i(s.cursor_ctx,s.fix_x,s.fix_y-10,s.fix_x,s.fix_y+10,"red",.5))}function i(e,t,n,a,r,i,o){e.globalAlpha=o,e.beginPath(),e.strokeStyle=i,e.moveTo(t,n),e.lineTo(a,r),e.closePath(),e.stroke()}function o(e){if(null!=s.mesh){var t=s.x,n=s.y;s.fix_x=t,s.fix_y=n,r(),s.params.clickHandlers.forEach(function(e){e({x:t,y:n})})}}var s=this;s.params=e,s.canvas=document.getElementById("draw_canvas"),s.context=s.canvas.getContext("2d"),s.cursor=document.getElementById("cursor_canvas"),s.cursor_ctx=s.cursor.getContext("2d"),s.mesh=null,s.cursor.addEventListener("mouseover",t,!1),s.cursor.addEventListener("mouseout",n,!1),s.cursor.addEventListener("mousemove",a,!1),s.cursor.addEventListener("click",o,!1),s.drawMesh=function(e){s.mesh=e;var t=e.meshArray;s.canvas.width=s.cursor.width=t[0].length,s.canvas.height=s.cursor.height=t.length;var n=Array.prototype.concat.apply([],t),a=d3.max(n,function(e){return Number(e)});a=a>10?a:10,s.max=a;for(var i=s.context.getImageData(0,0,s.canvas.width,s.canvas.height),o=i.width,u=i.height,c=i.data,d=0;d<u;++d)for(var l=0;l<o;++l){var h=4*(d*o+l),m=t[d][l],f=255*m/a,p=255-f;c[h+0]=p,c[h+1]=p,c[h+2]=p,c[h+3]=255}s.canvas.style.display="block",document.getElementById("drop_msg").style.display="none",s.context.putImageData(i,0,0),document.getElementById("file_name").innerHTML=e.name,r()},s.moveFixCursor=function(e,t){s.fix_x+=e,s.fix_y+=t,r(),s.params.clickHandlers.forEach(function(e){e({x:s.fix_x,y:s.fix_y})})}}e.exports=n},function(e,t,n){function a(e){function t(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}function n(t){t.stopPropagation(),t.preventDefault();for(var n,a=t.dataTransfer.files,i=[],o=0;n=a[o];o++)i.push(n);i.sort(function(e,t){return e.name>t.name?1:e.name<t.name?-1:0});for(var o=0;o<i.length;o++){var n=i[o],s=(escape(n.name),new FileReader);s.onload=function(t){return function(n){var a=new r(t.name,n.target.result);e.createMeshHandlers.forEach(function(e){e(a)})}}(n),s.readAsText(n)}}this.params=e;var a=document.getElementById(e.id);a.addEventListener("dragover",t,!1),a.addEventListener("drop",n,!1)}var r=n(9);e.exports=a},function(e,t){var n=Vue.component("file-list",{template:'<ul id="file_list"><li v-for="mesh in meshes" v-bind:class="{\'selected-csv\': isActive(mesh)}">{{mesh.name}}</li></ul>',props:["meshes","active"],methods:{isActive:function(e){return e==this.active}}});e.exports=n},function(e,t,n){var a=n(0),r=Vue.component("google-map",{template:'<div id="map_canvas" style="margin-top: 0px; width:481px; height:505px"></div>',props:["active","x","y"],watch:{active:function(e){this.setHeartMap(e)},x:function(){this.setMarker()},y:function(){this.setMarker()}},mounted:function(){var e=this,t=new google.maps.LatLng(38.65,138.25),n={zoom:5,center:t,mapTypeId:google.maps.MapTypeId.ROADMAP};e.map=new google.maps.Map(document.getElementById("map_canvas"),n),e.marker=new google.maps.Marker({position:t}),e.heatmap=null},methods:{setHeartMap:function(e){for(var t=this,n=e.meshArray,r=20,i=0,o=Array.prototype.concat.apply([],n),s=0;s<o.length;s++)r<o[s]?r=o[s]:i>o[s]&&(i=o[s]);for(var u=n[0].length,c=n.length,d=[],l=0;l<c;++l)for(var h=0;h<u;++h){var m=n[l][h],f=255*(m-i)/(r-i),p=a.getLatitude(l),v=a.getLongitude(h);0!=f&&d.push({location:new google.maps.LatLng(p,v),weight:f})}null!=t.heatmap&&(t.heatmap.setMap(null),t.heatmap.setData([])),t.heatmap=new google.maps.visualization.HeatmapLayer({data:d,radius:10,maxIntensity:255,opacity:.4}),t.heatmap.setMap(t.map)},setMarker:function(){var e=this,t=a.getLatitude(e.y),n=a.getLongitude(e.x),r=new google.maps.LatLng(t,n);e.map.panTo(r),e.marker.setMap(e.map),e.marker.setPosition(r)}}});e.exports=r},function(e,t){function n(e){function t(){a.params.changeActiveMeshHandlers.forEach(function(e){e(a.active)})}function n(){for(var e=0;e<a.meshes.length;e++)if(a.meshes[e]==a.active)return e;return 0}var a=this;a.params=e,a.meshes=[],a.active=null,a.add=function(e){a.meshes.push(e),a.meshes.sort(function(e,t){return e.name>t.name?1:e.name<t.name?-1:0}),a.params.changeCollectionHandlers.forEach(function(e){e(a.meshes)}),null==a.active&&(a.active=e,t())},a.pre=function(){var e=n();e-=1,e<0&&(e=a.meshes.length-1),a.active=a.meshes[e],t()},a.next=function(){var e=n();e+=1,e>=a.meshes.length&&(e=0),a.active=a.meshes[e],t()}}e.exports=n},function(e,t,n){var a=n(0),r=Vue.component("point-info",{template:'<div><table>  <tr><td>座標</td><td>{{pos}}</td></tr>  <tr><td>緯度・経度</td><td>{{lati}}</td></tr>  <tr><td>60進数</td><td>{{lati_60}}</td></tr>  <tr><td>降水量</td><td>{{value}}</td></tr></table><table class="around">  <tr><td>{{meshValue(-2,-2)}}</td><td>{{meshValue(-1,-2)}}</td><td>{{meshValue(0,-2)}}</td><td>{{meshValue(1,-2)}}</td><td>{{meshValue(2,-2)}}</td></tr>  <tr><td>{{meshValue(-2,-1)}}</td><td>{{meshValue(-1,-1)}}</td><td>{{meshValue(0,-1)}}</td><td>{{meshValue(1,-1)}}</td><td>{{meshValue(2,-1)}}</td></tr>  <tr><td>{{meshValue(-2, 0)}}</td><td>{{meshValue(-1, 0)}}</td><td>{{meshValue(0, 0)}}</td><td>{{meshValue(1, 0)}}</td><td>{{meshValue(2, 0)}}</td></tr>  <tr><td>{{meshValue(-2, 1)}}</td><td>{{meshValue(-1, 1)}}</td><td>{{meshValue(0, 1)}}</td><td>{{meshValue(1, 1)}}</td><td>{{meshValue(2, 1)}}</td></tr>  <tr><td>{{meshValue(-2, 2)}}</td><td>{{meshValue(-1, 2)}}</td><td>{{meshValue(0, 2)}}</td><td>{{meshValue(1, 2)}}</td><td>{{meshValue(2, 2)}}</td></tr></table></div>',props:["mesh","x","y"],data:function(){return{pos:"",lati:"",lati_60:"",value:0}},watch:{mesh:function(){this.reflesh()},x:function(){this.reflesh()},y:function(){this.reflesh()}},methods:{reflesh:function(){var e=this;if(null!=e.mesh){var t=e.x,n=e.y,r=a.getLatitude(n),i=a.getLongitude(t),o=e.mesh.meshArray;e.pos="("+t+" , "+n+")",e.lati="("+r+" , "+i+")",e.lati_60=e.conv60(r)+" , "+e.conv60(i),e.value=o[n][t]+" mm"}},meshValue:function(e,t){var n=this;if(null==n.mesh)return 0;var a=n.mesh.meshArray,t=n.x+t,e=n.y+e;return t<0||e<0||a[0].length<=t||a.length<=e?"-":a[e][t]},conv60:function(e){var t=Math.floor(e),n=Math.floor(60*(e-t));return t+"度 "+n+"分 "+Math.floor(60*(60*(e-t)-n))+"秒"}}});e.exports=r},function(e,t){function n(){function e(){var e=t.x,n=t.y,a=t.mesh.meshArray,r=d3.scaleLinear().domain([0,t.max]).range([55,5]);d3.select("svg#latitude_line polyline").transition().duration(100).attr("points",a[n].map(function(e,t){return t+" "+r(Number(e))}).join(","));var i=d3.scaleLinear().domain([0,t.max]).range([58,8]),o=a.map(function(t){return t[e]});d3.select("svg#longitude_line polyline").transition().duration(100).attr("points",o.map(function(e,t){return i(Number(e))+" "+t}).join(","))}var t=this;t.mesh=null,t.x=0,t.y=0,t.setMesh=function(n){t.mesh=n;var a=n.meshArray,r=Array.prototype.concat.apply([],a),i=d3.max(r,function(e){return Number(e)});i=i>10?i:10,t.max=i,e()},t.updateCoordinate=function(n){t.x=n.x,t.y=n.y,e()}}e.exports=n},function(e,t){var n=Vue.component("timeline-graph",{template:'<svg id="timeline" width="505" height="60" style="margin-top: 0px; background: black; display: block;"></svg>',props:["meshes","active","x","y"],watch:{meshes:function(){this.reflesh()},active:function(){this.reflesh()},x:function(){this.reflesh()},y:function(){this.reflesh()}},methods:{reflesh:function(){if(null!=this.meshes&&0!=this.meshes.length){var e=this,t=e.x,n=e.y,a=d3.max(e.meshes,function(e){return Number(e.meshArray[n][t])}),r=481/e.meshes.length;r=r>20?20:r;var i=d3.scaleLinear().domain([0,a]).range([2,57]),o=d3.select("svg#timeline").selectAll("rect").data(e.meshes);o.enter().append("rect"),o.exit().remove(),o=d3.select("svg#timeline").selectAll("rect").transition().attr("x",function(e,t){return t*r}).attr("y",function(e){return 56-i(Number(e.meshArray[n][t]))}).attr("width",r-2).attr("height",function(e){return i(Number(e.meshArray[n][t]))}).attr("fill",function(t){return t==e.active?"#dccb18":"deepskyblue"})}}}});e.exports=n},function(e,t){function n(e,t){function n(e){return e.split("\n").filter(function(e){return""!=e}).map(function(e){return e.split(",").filter(function(e){return""!=e})})}var a=this;a.name=e,a.meshArray=n(t)}e.exports=n},function(e,t,n){var a=n(2),r=n(1),i=n(5),o=n(7),s=n(0);n(3),n(8),n(4),n(6);new Vue({el:"#app",data:{meshes:[],active:null,x:0,y:0,fix_x:0,fix_y:0},mounted:function(){var e=new o,t=new r({mapInfo:s,moveHandlers:[e.updateCoordinate,function(e){n.x=e.x,n.y=e.y}],clickHandlers:[function(e){n.fix_x=e.x,n.fix_y=e.y}]}),n=this,u=new i({changeCollectionHandlers:[function(e){n.meshes=e}],changeActiveMeshHandlers:[t.drawMesh,e.setMesh,function(e){n.active=e}]});new a({id:"drop_zone",createMeshHandlers:[u.add]});window.onload=function(){document.getElementById("pre_mesh").onclick=function(){u.pre()},document.getElementById("next_mesh").onclick=function(){u.next()},document.onkeydown=function(e){switch(e.keyCode){case 72:t.moveFixCursor(-1,0);break;case 74:t.moveFixCursor(0,1);break;case 75:t.moveFixCursor(0,-1);break;case 76:t.moveFixCursor(1,0)}}}}})}]);